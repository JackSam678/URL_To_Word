<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网页内容转Word工具</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 配置Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        neutral: '#1F2937',
                        light: '#F3F4F6'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .shadow-soft {
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            }
            .transition-custom {
                transition: all 0.3s ease;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans">
    <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <i class="fa fa-file-word-o text-primary text-3xl"></i>
                    <h1 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-neutral">网页内容转Word工具</h1>
                </div>
                <div class="hidden md:flex items-center space-x-4">
                    <a href="#" class="text-gray-600 hover:text-primary transition-custom">
                        <i class="fa fa-question-circle mr-1"></i>帮助
                    </a>
                    <a href="#" class="text-gray-600 hover:text-primary transition-custom">
                        <i class="fa fa-history mr-1"></i>历史记录
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- 工具卡片 -->
            <div class="bg-white rounded-xl shadow-soft p-6 md:p-8 mb-8">
                <h2 class="text-xl font-semibold text-neutral mb-6 flex items-center">
                    <i class="fa fa-cogs text-primary mr-2"></i>提取设置
                </h2>
                
                <form id="extractionForm" class="space-y-6">
                    <!-- URL输入 -->
                    <div class="space-y-2">
                        <label for="url" class="block text-sm font-medium text-gray-700">目标网页URL</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fa fa-link text-gray-400"></i>
                            </div>
                            <input 
                                type="url" 
                                id="url" 
                                name="url" 
                                placeholder="https://example.com/article" 
                                required
                                class="block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-custom"
                                value="https://blog.csdn.net/coldRing/article/details/146536328"
                            >
                        </div>
                    </div>
                    
                    <!-- 内容选择器 -->
                    <div class="space-y-2">
                        <label for="selector" class="block text-sm font-medium text-gray-700">内容区域选择器 (CSS)</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fa fa-code text-gray-400"></i>
                            </div>
                            <input 
                                type="text" 
                                id="selector" 
                                name="selector" 
                                placeholder="例如: div#content_views" 
                                class="block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-custom"
                                value="div#content_views"
                            >
                            <div class="text-xs text-gray-500 mt-1">
                                留空则提取整个页面内容，CSDN推荐: div#content_views
                            </div>
                        </div>
                    </div>
                    
                    <!-- 输出设置 -->
                    <div class="space-y-4">
                        <label class="block text-sm font-medium text-gray-700">输出设置</label>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- 输出文件名 -->
                            <div class="space-y-2">
                                <label for="filename" class="block text-sm font-medium text-gray-700">Word文件名</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i class="fa fa-file-text-o text-gray-400"></i>
                                    </div>
                                    <input 
                                        type="text" 
                                        id="filename" 
                                        name="filename" 
                                        placeholder="网页内容提取结果" 
                                        class="block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-custom"
                                        value="教程文章提取结果"
                                    >
                                </div>
                            </div>
                            
                            <!-- 输出路径 -->
                            <div class="space-y-2">
                                <label for="outputDir" class="block text-sm font-medium text-gray-700">输出目录</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i class="fa fa-folder-open-o text-gray-400"></i>
                                    </div>
                                    <input 
                                        type="text" 
                                        id="outputDir" 
                                        name="outputDir" 
                                        placeholder="默认: 当前目录/web2word_output" 
                                        class="block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-custom"
                                    >
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="pt-4 flex flex-col sm:flex-row gap-4">
                        <button 
                            type="submit" 
                            id="startBtn"
                            class="flex-1 bg-primary hover:bg-primary/90 text-white font-medium py-3 px-6 rounded-lg transition-custom flex items-center justify-center"
                        >
                            <i class="fa fa-play mr-2"></i>开始提取
                        </button>
                        <button 
                            type="button" 
                            id="resetBtn"
                            class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-3 px-6 rounded-lg transition-custom"
                        >
                            <i class="fa fa-refresh mr-2"></i>重置
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- 进度和结果区域 -->
            <div id="progressSection" class="bg-white rounded-xl shadow-soft p-6 md:p-8 hidden">
                <h2 class="text-xl font-semibold text-neutral mb-6 flex items-center">
                    <i class="fa fa-spinner fa-spin text-primary mr-2"></i>处理进度
                </h2>
                
                <!-- 进度条 -->
                <div class="mb-6">
                    <div class="flex justify-between text-sm mb-1">
                        <span id="progressText">准备中...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="progressBar" class="bg-primary h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>
                
                <!-- 日志区域 -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">处理日志</label>
                    <div id="logArea" class="w-full h-40 bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-y-auto text-sm">
                        <p class="text-gray-600">等待开始处理...</p>
                    </div>
                </div>
                
                <!-- 结果区域 (初始隐藏) -->
                <div id="resultSection" class="hidden">
                    <div class="p-4 bg-green-50 border border-green-200 rounded-lg mb-4">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fa fa-check-circle text-green-500 text-xl"></i>
                            </div>
                            <div class="ml-3">
                                <h3 class="text-sm font-medium text-green-800">处理完成</h3>
                                <div class="mt-2 text-sm text-green-700">
                                    <p id="resultMessage"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-center">
                        <button id="openFolderBtn" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-secondary hover:bg-secondary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-secondary transition-custom">
                            <i class="fa fa-folder-open mr-2"></i>打开输出目录
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-white border-t mt-12">
        <div class="container mx-auto px-4 py-6">
            <div class="text-center text-gray-500 text-sm">
                <p>网页内容转Word工具 &copy; 2023</p>
                <p class="mt-1">使用Python和Web技术构建</p>
            </div>
        </div>
    </footer>

    <script>
        // DOM元素
        const form = document.getElementById('extractionForm');
        const progressSection = document.getElementById('progressSection');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const progressPercent = document.getElementById('progressPercent');
        const logArea = document.getElementById('logArea');
        const resultSection = document.getElementById('resultSection');
        const resultMessage = document.getElementById('resultMessage');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const openFolderBtn = document.getElementById('openFolderBtn');
        
        // 模拟处理进度
        let currentProgress = 0;
        let progressInterval;
        let outputDir = '';
        
        // 日志添加函数
        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('p');
            logEntry.className = 'mb-1 text-gray-600';
            logEntry.innerHTML = `<span class="text-gray-400">[${timestamp}]</span> ${message}`;
            logArea.appendChild(logEntry);
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        // 更新进度函数
        function updateProgress(percent, text) {
            currentProgress = percent;
            progressBar.style.width = `${percent}%`;
            progressPercent.textContent = `${percent}%`;
            progressText.textContent = text;
            
            if (percent === 100) {
                clearInterval(progressInterval);
                setTimeout(() => {
                    resultSection.classList.remove('hidden');
                    resultMessage.textContent = `Word文档已保存至: ${outputDir}`;
                }, 500);
            }
        }
        
        // 模拟处理过程
        function simulateProcessing(formData) {
            // 显示进度区域
            progressSection.classList.remove('hidden');
            resultSection.classList.add('hidden');
            logArea.innerHTML = '';
            updateProgress(0, '准备处理...');
            
            // 获取表单数据
            const url = formData.get('url');
            const selector = formData.get('selector');
            const filename = formData.get('filename');
            outputDir = formData.get('outputDir') || '当前目录/web2word_output';
            
            // 添加初始日志
            addLog(`开始处理网页: ${url}`);
            addLog(`内容选择器: ${selector || '整个页面'}`);
            addLog(`输出目录: ${outputDir}`);
            
            // 模拟进度更新
            let step = 0;
            const steps = [
                { percent: 10, text: '正在连接网页...', log: '成功连接到目标网页' },
                { percent: 25, text: '正在解析网页结构...', log: '网页结构解析完成' },
                { percent: 40, text: '正在提取文字内容...', log: '文字内容提取完成' },
                { percent: 70, text: '正在下载图片...', log: '所有图片下载完成' },
                { percent: 90, text: '正在生成Word文档...', log: 'Word文档生成中' },
                { percent: 100, text: '处理完成', log: `文档 "${filename}.docx" 已保存` }
            ];
            
            progressInterval = setInterval(() => {
                if (step < steps.length) {
                    updateProgress(steps[step].percent, steps[step].text);
                    addLog(steps[step].log);
                    step++;
                } else {
                    clearInterval(progressInterval);
                }
            }, 1500);
        }
        
        // 表单提交处理
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(form);
            simulateProcessing(formData);
        });
        
        // 重置按钮
        resetBtn.addEventListener('click', () => {
            form.reset();
            clearInterval(progressInterval);
            progressSection.classList.add('hidden');
            currentProgress = 0;
        });
        
        // 打开文件夹按钮
        openFolderBtn.addEventListener('click', () => {
            addLog(`尝试打开目录: ${outputDir}`);
            // 实际应用中，这里需要后端配合打开文件管理器
            alert(`在实际应用中，这里会打开目录: ${outputDir}`);
        });
    </script>
</body>
</html>
